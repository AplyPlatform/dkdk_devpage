<?php
session_start();

$retmail = $_SESSION['user_id'];
$service_kind = $_SESSION['kind'];
$accessToken = $_SESSION['token'];

setExpire($service_kind, $accessToken);

session_destroy();
?>
<meta http-equiv='refresh' content='0;url=index.php'>
<?
function setExpire($service_kind, $accessToken) {
  $requrl = "";

  if ($service_kind == "naver")
    $requrl = "https://nid.naver.com/oauth2.0/token?grant_type=delete&client_id=wSvRwDA6qt1OWrvVY542&client_secret=L6W0fHMav2&access_token=<?echo $accessToken?>&service_provider=NAVER";
  else if ($service_kind == "facebook")
    $requrl = "https://www.facebook.com/logout.php?next=http://dkdk.io/center&access_token=<?echo $accessToken?>";
  else if ($service_kind == "google")
    $requrl = "https://accounts.google.com/o/oauth2/revoke?token=<?echo $accessToken?>";


  $ch4 = curl_init();
  curl_setopt($ch4, CURLOPT_RETURNTRANSFER,1);
  curl_setopt($ch4, CURLOPT_URL, $requrl );
  curl_setopt($ch4, CURLOPT_SSL_VERIFYPEER, false);

  if(!$result = curl_exec($ch4))
  {
    echo curl_error($ch4);
  } else {
    $res = json_decode($result);
    return $res->email;
  }

  curl_close($ch4);

  return "";
}
?>
